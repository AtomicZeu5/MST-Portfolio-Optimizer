<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MST Portfolio Optimizer - Indian Stock Market</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-brand">MST Portfolio Optimizer</div>
            <div class="nav-links">
                <a href="#home" class="nav-link active">Home</a>
                <a href="#network" class="nav-link">MST Network</a>
                <a href="#centrality" class="nav-link">Centrality Analysis</a>
                <a href="#portfolio" class="nav-link">Portfolio Comparison</a>
                <a href="#methodology" class="nav-link">Methodology</a>
            </div>
        </div>
    </nav>

    <!-- Home Section -->
    <section id="home" class="section active-section">
        <div class="container">
            <div class="hero">
                <h1 class="hero-title">MST Portfolio Optimizer - Indian Stock Market</h1>
                <h2 class="hero-subtitle">Build diversified portfolios using graph theory and network analysis</h2>
                <p class="hero-description">
                    Use advanced network science and graph theory to construct optimized portfolios from 25 top Indian stocks.
                    Our MST-based approach analyzes stock correlations and centrality measures to identify
                    diversification opportunities that traditional methods miss.
                </p>
                <div class="hero-stats">
                    <div class="stat-item">
                        <div class="stat-value">25</div>
                        <div class="stat-label">Stocks Analyzed</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value">13</div>
                        <div class="stat-label">Sectors Covered</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value">24</div>
                        <div class="stat-label">Network Connections</div>
                    </div>
                </div>
                <button class="btn btn--primary btn--lg" onclick="navigateToNetwork()">Get Started</button>
            </div>

            <div class="features-grid">
                <div class="feature-card" style="background: var(--color-bg-1);">
                    <div class="feature-icon">üåê</div>
                    <h3>Interactive Network</h3>
                    <p>Explore the MST connecting 25 Indian stocks. See correlations, centrality measures, and sector relationships in real-time.</p>
                </div>
                <div class="feature-card" style="background: var(--color-bg-2);">
                    <div class="feature-icon">üìä</div>
                    <h3>Smart Allocation</h3>
                    <p>Compare three scientifically-backed strategies: Inverse Centrality, MST Diversification, and Equal Weight portfolios.</p>
                </div>
                <div class="feature-card" style="background: var(--color-bg-3);">
                    <div class="feature-icon">üí∞</div>
                    <h3>Custom Investment</h3>
                    <p>Input your investment amount and get personalized recommendations with exact share quantities for each stock.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- MST Network Section -->
    <section id="network" class="section">
        <div class="container">
            <h2 class="section-title">MST Network Visualization</h2>
            <p class="section-description">
                Interactive network graph showing the Minimum Spanning Tree connections between stocks.
                Edges represent correlations, with thickness proportional to correlation strength.
                Hover over nodes and edges for detailed information.
            </p>

            <div class="controls-panel">
                <div class="control-group">
                    <label class="control-label">Color by:</label>
                    <select id="colorBy" class="form-control">
                        <option value="sector">Sector</option>
                        <option value="degree">Degree Centrality</option>
                        <option value="betweenness">Betweenness Centrality</option>
                        <option value="eigenvector">Eigenvector Centrality</option>
                    </select>
                </div>
                <div class="control-group">
                    <label class="control-label">Filter by sector:</label>
                    <select id="sectorFilter" class="form-control">
                        <option value="all">All Sectors</option>
                    </select>
                </div>
                <button class="btn btn--secondary btn--sm" onclick="resetNetworkView()">Reset View</button>
            </div>

            <div class="card">
                <div class="card__body">
                    <div id="network-graph" class="network-container"></div>
                </div>
            </div>

            <div class="legend-container">
                <div class="legend-section">
                    <h4>Sector Legend</h4>
                    <div id="sector-legend" class="legend-items"></div>
                </div>
                <div class="legend-section">
                    <h4>Edge Thickness</h4>
                    <p>Thickness is proportional to correlation strength (thicker = stronger correlation)</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Centrality Analysis Section -->
    <section id="centrality" class="section">
        <div class="container">
            <h2 class="section-title">Centrality Measures Analysis</h2>
            <p class="section-description">
                Analysis of three key centrality measures that identify systemically important stocks in the network.
                Click on bars to highlight stocks across all metrics.
            </p>

            <div class="metrics-cards">
                <div class="metric-card">
                    <h4>Degree Centrality</h4>
                    <p>Number of direct connections a stock has in the MST</p>
                </div>
                <div class="metric-card">
                    <h4>Betweenness Centrality</h4>
                    <p>Frequency a stock appears on shortest paths between other stocks</p>
                </div>
                <div class="metric-card">
                    <h4>Eigenvector Centrality</h4>
                    <p>Influence based on connections to other highly connected stocks</p>
                </div>
            </div>

            <div class="card">
                <div class="card__body">
                    <div class="chart-container">
                        <canvas id="centralityChart"></canvas>
                    </div>
                </div>
            </div>

            <div class="card" style="margin-top: 24px;">
                <div class="card__body">
                    <h3 style="margin-bottom: 16px;">Top 5 Most Central Stocks</h3>
                    <div class="table-container">
                        <table id="centralityTable" class="data-table">
                            <thead>
                                <tr>
                                    <th>Rank</th>
                                    <th>Stock</th>
                                    <th>Degree</th>
                                    <th>Betweenness</th>
                                    <th>Eigenvector</th>
                                    <th>Average</th>
                                </tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Portfolio Comparison Section -->
    <section id="portfolio" class="section">
        <div class="container">
            <h2 class="section-title">Portfolio Strategy Comparison</h2>
            <p class="section-description">
                Comparison of three portfolio construction strategies: Inverse Centrality (favoring peripheral stocks),
                MST Diversification (balanced network approach), and Equal Weight (benchmark).
            </p>

            <div class="card">
                <div class="card__body">
                    <h3 style="margin-bottom: 16px;">Performance Metrics Comparison</h3>
                    <div class="chart-grid">
                        <div class="chart-wrapper">
                            <canvas id="returnChart"></canvas>
                        </div>
                        <div class="chart-wrapper">
                            <canvas id="volatilityChart"></canvas>
                        </div>
                        <div class="chart-wrapper">
                            <canvas id="sharpeChart"></canvas>
                        </div>
                        <div class="chart-wrapper">
                            <canvas id="drawdownChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>

            <div class="card" style="margin-top: 24px;">
                <div class="card__body">
                    <h3 style="margin-bottom: 16px;">Investment Calculator</h3>
                    <div class="investment-calculator">
                        <div class="calc-input-group">
                            <label class="control-label">Investment Amount (‚Çπ):</label>
                            <div class="amount-buttons">
                                <button class="btn btn--outline btn--sm" onclick="setInvestment(10000)">‚Çπ10,000</button>
                                <button class="btn btn--outline btn--sm" onclick="setInvestment(50000)">‚Çπ50,000</button>
                                <button class="btn btn--outline btn--sm" onclick="setInvestment(100000)">‚Çπ1,00,000</button>
                                <button class="btn btn--outline btn--sm" onclick="setInvestment(500000)">‚Çπ5,00,000</button>
                            </div>
                            <input type="number" id="investmentAmount" class="form-control" placeholder="Enter custom amount" value="100000" min="1000" step="1000">
                        </div>
                        <div class="calc-input-group">
                            <label class="control-label">Select Strategy:</label>
                            <select id="strategySelect" class="form-control">
                                <option value="inverse">Inverse Centrality</option>
                                <option value="mst">MST Diversification</option>
                                <option value="equal">Equal Weight</option>
                            </select>
                        </div>
                        <button class="btn btn--primary" onclick="calculatePortfolio()">Calculate Portfolio</button>
                        <button class="btn btn--secondary" onclick="downloadPortfolio()">Download as CSV</button>
                    </div>
                    <div id="portfolioResults" class="portfolio-results" style="display: none;"></div>
                </div>
            </div>

            <div class="card" style="margin-top: 24px;">
                <div class="card__body">
                    <h3 style="margin-bottom: 16px;">Portfolio Allocations</h3>
                    <div class="allocation-grid">
                        <div class="allocation-item">
                            <h4>Inverse Centrality</h4>
                            <div class="pie-container">
                                <canvas id="pieInverse"></canvas>
                            </div>
                        </div>
                        <div class="allocation-item">
                            <h4>MST Diversification</h4>
                            <div class="pie-container">
                                <canvas id="pieMST"></canvas>
                            </div>
                        </div>
                        <div class="allocation-item">
                            <h4>Equal Weight</h4>
                            <div class="pie-container">
                                <canvas id="pieEqual"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="card" style="margin-top: 24px;">
                <div class="card__body">
                    <h3 style="margin-bottom: 16px;">Summary Statistics</h3>
                    <div class="table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Strategy</th>
                                    <th>Annual Return</th>
                                    <th>Annualized Volatility</th>
                                    <th>Sharpe Ratio</th>
                                    <th>Max Drawdown</th>
                                </tr>
                            </thead>
                            <tbody id="performanceTableBody"></tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Methodology Section -->
    <section id="methodology" class="section">
        <div class="container">
            <h2 class="section-title">Methodology</h2>
            <p class="section-description">
                Mathematical foundation and algorithmic approach for MST-based portfolio construction.
            </p>

            <div class="methodology-content">
                <div class="card">
                    <div class="card__body">
                        <h3>1. MST Construction Process</h3>
                        <p>The Minimum Spanning Tree is constructed from stock correlations using the following steps:</p>
                        <ol class="methodology-list">
                            <li>Compute pairwise correlations œÅ<sub>ij</sub> between all stocks</li>
                            <li>Convert correlations to distances: d<sub>ij</sub> = ‚àö(2(1 - œÅ<sub>ij</sub>))</li>
                            <li>Apply Kruskal's or Prim's algorithm to find the MST</li>
                            <li>Result: A tree connecting all stocks with minimum total distance</li>
                        </ol>
                        <div class="formula-box">
                            <strong>Distance Metric:</strong><br>
                            d<sub>ij</sub> = ‚àö(2(1 - œÅ<sub>ij</sub>))<br>
                            where œÅ<sub>ij</sub> ‚àà [-1, 1] is the correlation coefficient
                        </div>
                    </div>
                </div>

                <div class="card">
                    <div class="card__body">
                        <h3>2. Centrality Measures</h3>
                        
                        <h4>Degree Centrality</h4>
                        <p>Measures the number of direct connections a node has:</p>
                        <div class="formula-box">
                            C<sub>D</sub>(v) = deg(v) / (n - 1)
                        </div>
                        <p>where deg(v) is the degree of node v and n is the total number of nodes.</p>

                        <h4>Betweenness Centrality</h4>
                        <p>Quantifies how often a node appears on shortest paths between other nodes:</p>
                        <div class="formula-box">
                            C<sub>B</sub>(v) = Œ£<sub>s‚â†v‚â†t</sub> (œÉ<sub>st</sub>(v) / œÉ<sub>st</sub>)
                        </div>
                        <p>where œÉ<sub>st</sub> is the number of shortest paths from s to t, and œÉ<sub>st</sub>(v) is the number passing through v.</p>

                        <h4>Eigenvector Centrality</h4>
                        <p>Measures influence based on connections to other influential nodes:</p>
                        <div class="formula-box">
                            C<sub>E</sub>(v) = (1/Œª) Œ£<sub>u‚ààN(v)</sub> C<sub>E</sub>(u)
                        </div>
                        <p>where Œª is the largest eigenvalue of the adjacency matrix and N(v) are neighbors of v.</p>
                    </div>
                </div>

                <div class="card">
                    <div class="card__body">
                        <h3>3. Portfolio Weighting Schemes</h3>
                        
                        <h4>Inverse Centrality Portfolio</h4>
                        <p>Assigns higher weights to peripheral stocks with lower centrality:</p>
                        <div class="formula-box">
                            w<sub>i</sub> = (1/C<sub>i</sub>) / Œ£<sub>j</sub>(1/C<sub>j</sub>)
                        </div>
                        <p>where C<sub>i</sub> is the average normalized centrality of stock i.</p>

                        <h4>MST Diversification Portfolio</h4>
                        <p>Balances centrality and network position for optimal diversification:</p>
                        <div class="formula-box">
                            w<sub>i</sub> = f(d<sub>i</sub>, C<sub>i</sub>) / Œ£<sub>j</sub> f(d<sub>j</sub>, C<sub>j</sub>)
                        </div>
                        <p>where d<sub>i</sub> is the average edge distance and f combines multiple factors.</p>

                        <h4>Equal Weight Portfolio (Benchmark)</h4>
                        <p>Simple benchmark strategy with equal allocation:</p>
                        <div class="formula-box">
                            w<sub>i</sub> = 1/n
                        </div>
                        <p>where n is the number of stocks in the portfolio.</p>
                    </div>
                </div>

                <div class="card">
                    <div class="card__body">
                        <h3>4. Performance Evaluation</h3>
                        
                        <h4>Sharpe Ratio</h4>
                        <div class="formula-box">
                            SR = (R<sub>p</sub> - R<sub>f</sub>) / œÉ<sub>p</sub>
                        </div>
                        <p>where R<sub>p</sub> is portfolio return, R<sub>f</sub> is risk-free rate, and œÉ<sub>p</sub> is portfolio volatility.</p>

                        <h4>Maximum Drawdown</h4>
                        <div class="formula-box">
                            MDD = max<sub>t</sub>[(max<sub>œÑ‚â§t</sub> V<sub>œÑ</sub> - V<sub>t</sub>) / max<sub>œÑ‚â§t</sub> V<sub>œÑ</sub>]
                        </div>
                        <p>where V<sub>t</sub> is the portfolio value at time t.</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <script src="app.js"></script>
</body>
</html>